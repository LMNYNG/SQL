WITH RECURSIVE COST AS(
	SELECT 0 AS C
	UNION ALL
	SELECT C+10000
	FROM COST
	WHERE C<(SELECT MAX(PRICE)-10000 FROM PRODUCT )
)


SELECT C AS PRICE_GROUP, COALESCE(COUNT(PRODUCT_CODE),0) AS PRODUCTS
FROM COST LEFT OUTER JOIN PRODUCT ON COST.C IS NOT NULL
WHERE PRODUCT.PRICE BETWEEN C AND C+9999
GROUP BY C
ORDER BY C
