SELECT DISTINCT A.ITEM_ID, A.ITEM_NAME, A.RARITY
FROM ITEM_INFO A, ITEM_TREE B
WHERE B.PARENT_ITEM_ID IN (SELECT A.ITEM_ID
                           FROM   ITEM_INFO A, ITEM_TREE B
                           WHERE  B.PARENT_ITEM_ID = A.ITEM_ID AND A.RARITY='RARE')
      AND A.ITEM_ID=B.ITEM_ID
ORDER BY ITEM_ID DESC
