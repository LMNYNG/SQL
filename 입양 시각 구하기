WITH RECURSIVE HOUR AS(
    SELECT 0 AS H
    UNION ALL
    SELECT H + 1
    FROM HOUR
    WHERE H < 23
)

SELECT H AS HOUR, COALESCE(COUNT(ANIMAL_ID),0) AS COUNT
FROM HOUR A LEFT OUTER JOIN ANIMAL_OUTS B ON A.H = HOUR(B.DATETIME)
GROUP BY H
ORDER BY H
